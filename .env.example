# ============================================
# StoryQuest - Environment Variables Template
# ============================================
# Copy this file to .env.local for development
# Copy to Vercel Environment Variables for production

# ============================================
# DATABASE
# ============================================
# PostgreSQL connection string
# Development: Can use local PostgreSQL or Neon free tier
# Production: Use Neon (https://neon.tech) - recommended
DATABASE_URL="postgresql://user:password@localhost:5432/storyquest"

# Direct connection for Prisma migrations (Neon only)
# Get this from Neon dashboard (disable connection pooling)
DIRECT_URL="postgresql://user:password@localhost:5432/storyquest"

# ============================================
# AUTHENTICATION (NextAuth.js v5)
# ============================================
# Generate with: openssl rand -base64 32
# CRITICAL: Use DIFFERENT secrets for dev and production!
NEXTAUTH_SECRET="" # MUST be at least 32 characters

# Your application URL
# Development: http://localhost:3000
# Production: https://your-domain.com (no trailing slash)
NEXTAUTH_URL="http://localhost:3000"

# Session duration (seconds)
# Default: 2592000 (30 days)
# Recommended production: 604800 (7 days) for security
SESSION_MAX_AGE="604800"

# ============================================
# STRIPE PAYMENTS
# ============================================
# Get from: https://dashboard.stripe.com/apikeys
# IMPORTANT: Use test keys for development, live keys for production

# Publishable key (public, safe in client-side code)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY="pk_test_..."

# Secret key (NEVER expose to client)
STRIPE_SECRET_KEY="sk_test_..."

# Webhook signing secret (get from Stripe webhook settings)
# Development: Use Stripe CLI for local testing
# Production: Create webhook endpoint in Stripe dashboard
STRIPE_WEBHOOK_SECRET="whsec_..."

# Product Price IDs (create these in Stripe Dashboard > Products)
STRIPE_PRICE_ID_PRO="price_..." # £9.99/month Pro tier
STRIPE_PRICE_ID_PREMIUM="price_..." # £19.99/month Premium tier

# ============================================
# EMAIL (Resend)
# ============================================
# Get API key from: https://resend.com/api-keys
RESEND_API_KEY="re_..."

# Email sender address (must be verified in Resend)
# Development: Can use onboarding@resend.dev for testing
# Production: MUST use your own verified domain
EMAIL_FROM="hello@storyquest.org.uk"
EMAIL_FROM_NAME="StoryQuest Team"

# ============================================
# FILE STORAGE (for story images/audio)
# ============================================
# Option 1: Vercel Blob Storage (recommended, easiest setup)
# Get from: https://vercel.com/dashboard/stores
BLOB_READ_WRITE_TOKEN="vercel_blob_..."

# Option 2: AWS S3 (alternative - uncomment if using)
# AWS_ACCESS_KEY_ID="..."
# AWS_SECRET_ACCESS_KEY="..."
# AWS_REGION="eu-west-2"
# AWS_S3_BUCKET="storyquest-media"

# ============================================
# AI SERVICES (Optional)
# ============================================
# OpenAI (for TTS audio generation, story content generation)
# Get from: https://platform.openai.com/api-keys
OPENAI_API_KEY=""

# ElevenLabs (for high-quality TTS - better than OpenAI)
# Get from: https://elevenlabs.io/
ELEVENLABS_API_KEY=""

# ============================================
# ANALYTICS & MONITORING
# ============================================
# PostHog (product analytics - free tier available)
# Get from: https://app.posthog.com/project/settings
NEXT_PUBLIC_POSTHOG_KEY=""
NEXT_PUBLIC_POSTHOG_HOST="https://app.posthog.com"

# Sentry (error tracking - recommended for production)
# Get from: https://sentry.io/settings/projects/
NEXT_PUBLIC_SENTRY_DSN=""
SENTRY_AUTH_TOKEN=""

# Vercel Analytics (automatically enabled on Vercel, no setup needed)
# No environment variables required

# ============================================
# RATE LIMITING (Production Recommended)
# ============================================
# Upstash Redis (free tier available)
# Get from: https://console.upstash.com/
# Prevents API abuse and brute force attacks
UPSTASH_REDIS_REST_URL=""
UPSTASH_REDIS_REST_TOKEN=""

# ============================================
# APPLICATION SETTINGS
# ============================================
# Your public app URL (used in emails, redirects, meta tags)
NEXT_PUBLIC_URL="http://localhost:3000"

# Environment (set automatically by Node.js)
NODE_ENV="development"

# CORS allowed origins (comma-separated)
# Production: Your actual domain only
ALLOWED_ORIGINS="http://localhost:3000"

# ============================================
# FEATURE FLAGS
# ============================================
# Toggle features without code changes
NEXT_PUBLIC_ENABLE_SUBSCRIPTIONS="true"
NEXT_PUBLIC_ENABLE_PROFESSIONAL_TOOLS="false"
NEXT_PUBLIC_ENABLE_AUDIO_NARRATION="true"
NEXT_PUBLIC_ENABLE_ACHIEVEMENTS="true"
NEXT_PUBLIC_ENABLE_ANALYTICS="false"

# ============================================
# LINKEDIN API (Future Feature - Not MVP)
# ============================================
# Get from: https://www.linkedin.com/developers/
# LINKEDIN_CLIENT_ID="..."
# LINKEDIN_CLIENT_SECRET="..."

# ============================================
# DEPLOYMENT CHECKLIST
# ============================================
# Before Production Launch:
# [ ] Generate new NEXTAUTH_SECRET (different from dev)
# [ ] Switch Stripe keys to live mode (pk_live_, sk_live_)
# [ ] Create production webhook in Stripe dashboard
# [ ] Verify domain in Resend and update EMAIL_FROM
# [ ] Set NEXT_PUBLIC_URL to production domain
# [ ] Set SESSION_MAX_AGE to 7 days (604800)
# [ ] Enable rate limiting (add Upstash credentials)
# [ ] Set up error monitoring (Sentry)
# [ ] Set up analytics (PostHog)
# [ ] Update ALLOWED_ORIGINS to production domain only
# [ ] Test all environment variables work in Vercel preview
# [ ] Never commit .env.local to git (it's in .gitignore)

# ============================================
# SECURITY NOTES
# ============================================
# 1. NEVER commit .env files with real values to git
# 2. Use different secrets for dev, preview, and production
# 3. Rotate NEXTAUTH_SECRET if exposed
# 4. Keep Stripe secret key secure (never log it)
# 5. Use .env.local for local development (not .env)
# 6. Set environment variables in Vercel dashboard, not in code
# 7. Review Vercel logs to ensure no secrets are leaked
# 8. Enable Vercel deployment protection for production

# ============================================
# COST ESTIMATES (as of 2025)
# ============================================
# Neon (database): £0/month (free tier, 500MB storage)
# Vercel (hosting): £0/month (hobby tier, 100GB bandwidth)
# Stripe (payments): 1.5% + 20p per transaction
# Resend (email): £0/month (free tier, 100 emails/day)
# Upstash Redis: £0/month (free tier, 10K requests/day)
# PostHog: £0/month (free tier, 1M events/month)
# Sentry: £0/month (free tier, 5K errors/month)
# TOTAL: ~£0-2/month for first 100 users
